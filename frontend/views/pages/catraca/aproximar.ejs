<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interface Catraca</title>
    <link rel="stylesheet" href="css/catraca.css">
    
</head>

<body>
    <div class="container">
        <h4 id="data-e-hora"></h4>
        <h1>APROXIME O CARTÃO</h1>
        <img src="/img/aproximar.png" >
        <h6>Linha 115</h6>
        <p>www.SmartBus.com.br</p>
       

        <script>
          function mostrarDataHora() {
            const elementoDataHora = document.getElementById("data-e-hora");
            elementoDataHora.style.color = "#eaeaea"; // Define a cor principal do Bootstrap
            elementoDataHora.style.fontFamily = "Inria Sans, sans-serif"; // Define a fonte do Bootstrap
            elementoDataHora.style.fontWeight = "bold"; // Define o peso da fonte como negrito
            function atualizarDataHora() {
              const data = new Date();
              const dataFormatada = data.toLocaleDateString();
              const horaFormatada = data.toLocaleTimeString();
              elementoDataHora.textContent = `Data: ${dataFormatada} - Hora: ${horaFormatada}`;
            }
            setInterval(atualizarDataHora, 1000); // Atualiza a cada segundo
            atualizarDataHora(); // Para exibir imediatamente
          }

          mostrarDataHora();
        </script>
      </div>
    </div>





    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const leitor = document.querySelector("#leitor");
        leitor.focus();
      });


      // const leitor = document.querySelector("#leitor");
      // leitor.addEventListener("input", function() {
      //   alert("RFID:" + leitor.value);
      //   window.location.href = "/catraca/liberado";       
      // });
    </script>




  <script>
    function verificarSaldo() {
      // Simulação de consulta ao banco de dados
      const idDigitado = document.getElementById("leitor").value;
      const saldoNoBanco = obterSaldoDoBanco(idDigitado);

      if (saldoNoBanco >= 5) {
        // Caso o saldo seja suficiente
        deletarSaldoNoBanco(idDigitado, 5);
        window.location.href = "catraca/liberado";
      } else {
        // Caso o saldo seja insuficiente
        window.location.href = "catraca/negado";
      }
    }

    function obterSaldoDoBanco(id) {
      // Simulação da função para obter saldo do banco de dados
      // Substitua isso com sua lógica de consulta real
      const dadosDoBanco = {
        "123": 10, // Exemplo de ID e saldo
        "456": 3,
        // Adicione mais IDs e saldos conforme necessário
      };

      return dadosDoBanco[id] || 0;
    }

    function deletarSaldoNoBanco(id, valor) {
      // Simulação da função para deletar saldo do banco de dados
      // Substitua isso com sua lógica de remoção real
      // Normalmente, seria uma chamada AJAX para um servidor
      console.log(`Removendo ${valor} do saldo do ID ${id}`);
    }
  </script>



<form action="/verificar-saldo" method="post" onsubmit="return verificarSaldo()">
  <label for="leitor">AQUI VEM O ID</label>
  <input type="text" name="leitor" id="leitor" />
  <input type="submit" value="Verificar Saldo">
</form>

<script>
  document.addEventListener("DOMContentLoaded", function () {
      const leitor = document.querySelector("#leitor");
      leitor.focus();
  });

  function verificarSaldo() {
      const idDigitado = document.getElementById("leitor").value;
      const saldoNoBanco = obterSaldoDoBanco(idDigitado);

      if (saldoNoBanco >= 5) {
          deletarSaldoNoBanco(idDigitado, 5);
          alert("Saldo Suficiente. Redirecionando para Catraca Liberada.");
          window.location.href = "/catraca/liberado";
          return false; // Evitar que o formulário seja submetido
      } else {
          alert("Saldo Insuficiente. Redirecionando para Catraca Negada.");
          window.location.href = "/catraca/negado";
          return false; // Evitar que o formulário seja submetido
      }
  }

  function obterSaldoDoBanco(id) {
      const dadosDoBanco = {
          "123": 10,
          "456": 3,
      };

      return dadosDoBanco[id] || 0;
  }

  function deletarSaldoNoBanco(id, valor) {
      console.log(`Removendo ${valor} do saldo do ID ${id}`);
      // Adicione aqui a lógica real para remover o saldo no banco de dados
  }
</script>






</body>

